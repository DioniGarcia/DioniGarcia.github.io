webpackJsonp([1],{"/oeH":function(t,e,a){t.exports=a.p+"static/img/wnLogo.b9c560f.png"},"1/oy":function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},L8rs:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("7+uW"),s=a("zL8q"),r=a.n(s),o=(a("tvR6"),a("JR9b")),n=a.n(o),l=a("e6fC"),c=a("/ocq"),d=a("Xxa5"),u=a.n(d),p=a("exGp"),f=a.n(p),m=a("Sazm"),h=a.n(m),_={components:{Img:a("hpTH").a},name:"navbar",data:function(){return{frm_timestamp:"",isLoggedIn:!1,currentUser:!1}},created:function(){h.a.auth().currentUser&&(this.isLoggedIn=!0,this.currentUser=h.a.auth().currentUser.email)},methods:{logout:function(){var t=this;h.a.auth().signOut().then(function(){t.$router.push("./")})}}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"info"}},[i("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),i("b-navbar-brand",{staticStyle:{cursor:"default"}},[i("img",{attrs:{src:a("/oeH"),width:"48px",height:"48px"}})]),t._v(" "),i("b-navbar-brand",{staticStyle:{cursor:"default"}},[t._v("WatchNext")]),t._v(" "),i("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[i("b-navbar-nav",[i("b-nav-item",{staticClass:"nav-item"},[i("router-link",{staticClass:"menu-item",attrs:{to:"/dashboard"}},[t._v("Dashboard")])],1),t._v(" "),i("b-nav-item",{staticClass:"nav-item"},[i("router-link",{staticClass:"menu-item",attrs:{to:"/gestiones"}},[t._v("Gestiones")])],1)],1),t._v(" "),i("b-navbar-nav",{staticClass:"ml-auto"},[i("b-nav-item-dropdown",{attrs:{right:""}},[i("template",{slot:"button-content"},[i("em",{staticClass:"menu-item"},[t._v(t._s(t.currentUser))])]),t._v(" "),i("b-dropdown-item",{on:{click:t.logout}},[t._v("Logout")])],2)],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(_,v,!1,function(t){a("kwEI")},"data-v-33f1e434",null).exports,g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wn-task-data"},[a("h3",[400==this.prioridad?a("i",{staticClass:"fa fa-angle-double-up hot-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),300==this.prioridad?a("i",{staticClass:"fa fa-angle-up hot-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),200==this.prioridad?a("i",{staticClass:"fa fa-angle-up mid-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),100==this.prioridad?a("i",{staticClass:"fa fa-angle-down low-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),0==this.prioridad?a("i",{staticClass:"fa fa-angle-double-down muy-low-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v("\n      "+t._s(this.titulo)+"\n    ")]),t._v(" "),a("p",[a("b",[t._v("Operario:")]),t._v("  "+t._s(this.operario))]),t._v(" "),a("p",[a("b",[t._v("Duración:")]),t._v(" "),this.duracion<=this.estimado?a("span",[t._v(t._s(this.duracion))]):t._e(),t._v(" "),this.duracion>this.estimado&&this.duracion<2*this.estimado?a("span",{staticStyle:{color:"darkorange"}},[t._v(t._s(this.duracion))]):t._e(),t._v(" "),this.duracion>=2*this.estimado?a("span",{staticStyle:{color:"red"}},[t._v(t._s(this.duracion))]):t._e(),t._v("\n      / "+t._s(this.estimado)+" min")]),t._v(" "),t.showMore?a("div",{staticClass:"more-info"},[a("p",[a("b",[t._v("Id:")]),t._v(" "+t._s(this.id))]),t._v(" "),a("p",[a("b",[t._v("Pausable:")]),t._v(" "+t._s(this.pausable))]),t._v(" "),a("p",[a("b",[t._v("Descipción:")]),t._v("  "+t._s(this.descripcion))]),t._v(" "),t._m(0),t._v(" "),t._l(this.tags,function(e){return a("div",{staticClass:"el-tag"},[a("p",[t._v(t._s(e))])])}),t._v(" "),0==this.tags.length?a("p",[t._v("No hay etiquetas asignadas")]):t._e()],2):t._e(),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("b",[this._v("Etiquetas:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"end-line"},[e("p")])}]};var w=a("VU/8")({name:"task",props:["id","titulo","operario","duracion","estimado","prioridad","showMore","descripcion","pausable","tags","h_inicio"]},g,!1,function(t){a("Vyxl")},"data-v-2867e4d2",null).exports,k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wn-task-data"},[a("h3",[this.conectado?a("i",{staticClass:"conectado-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),this.conectado?t._e():a("i",{staticClass:"desconectado-icon",attrs:{"aria-hidden":"true"}}),t._v("\n    Sr/Sra. "+t._s(this.apellidos)+"\n\n  ")]),t._v(" "),a("p",[a("b",[t._v("Nombre completo")]),t._v(" "+t._s(this.nombre)+" "+t._s(this.apellidos))]),t._v(" "),a("p",[a("b",[t._v("Id:")]),t._v(" "+t._s(this.id))]),t._v(" "),t.showMore?a("div",{staticClass:"more-info"},[t._m(0),t._v(" "),t._l(this.tags,function(e){return a("div",{staticClass:"el-tag"},[a("p",[t._v(t._s(e))])])}),t._v(" "),0==this.tags.length?a("p",[t._v("No hay etiquetas asignadas")]):t._e()],2):t._e(),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("b",[this._v("Etiquetas:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"end-line"},[e("p")])}]};var C=a("VU/8")({name:"task",props:["id","nombre","apellidos","tags","showMore","conectado"]},k,!1,function(t){a("NJ2c")},"data-v-8af132a4",null).exports,q=(a("3VHS"),h.a.initializeApp({apiKey:"AIzaSyB1tt5aOxrLkQH-nLFKu4PWVrJnZQOMhiU",authDomain:"wane-3630f.firebaseapp.com",databaseURL:"https://wane-3630f.firebaseio.com",projectId:"wane-3630f",storageBucket:"wane-3630f.appspot.com",messagingSenderId:"858046686031"}).firestore()),x=a("X1Qo"),y=a("28+M"),O=a.n(y),V={name:"gTemplates",data:function(){return{operariosVisible:!1,nuevaPlantillaVisible:!1,searchVisible:!1,searchVisibleOperario:!1,searchVisibleFinalizadas:!1,dialogEditVisible:!1,operariosEditVisible:!1,templates:[],operarios:[],tasks_realizadas:[],frmP_operario:"",frmP_asignable:!0,frmP_titulo:"",frmP_descripcion:"",frmP_estimado:"",frmP_prioridad:200,frmP_pausable:!1,frmP_etiquetas:[],frmO_nombre:"",frmO_apellidos:"",frmO_pass:"",frmO_pass_2:"",frmO_conectado:!1,frmO_tareas:[],frmO_etiquetas:[],prioridades:[{value:400,text:"Urgente"},{value:300,text:"Alta"},{value:200,text:"Media"},{value:100,text:"Baja"},{value:0,text:"Muy baja"}],searchWord:"",searchWordOperario:"",searchWordFinalizadas:"",tagRecomendations:[],inputVisible:!1,inputValue:"",inputVisibleOp:!1,inputValueOp:"",id:"",loading:!0}},created:function(){var t=this;q.collection("plantillas").get().then(function(e){t.loading=!1,e.forEach(function(e){var a={id:e.id,operario:"Se asignará durante la ejecución",titulo:e.data().titulo,duracion:0,estimado:e.data().estimado,prioridad:e.data().prioridad,descripcion:e.data().descripcion,showMore:!1,pausable:e.data().pausable,tags:e.data().etiquetas};t.templates.push(a)})}),q.collection("operarios").onSnapshot(function(e){t.loading=!1,t.operarios.length=0,e.forEach(function(e){var a={nombre:e.data().nombre,apellidos:e.data().apellidos,pass:e.data().pass,id:e.id,tags:e.data().etiquetas,showMore:!1,conectado:e.data().conectado};t.operarios.push(a),t.operarios.sort(function(t,e){return!t.conectado&&e.conectado})})}),q.collection("finalizadas").onSnapshot(function(e){t.tasks_realizadas.length=0,e.forEach(function(e){var a={id:e.id,operario:e.data().operario,titulo:e.data().titulo,duracion:Math.round((e.data().h_fin.getTime()-e.data().h_inicio.getTime())/6e4),estimado:e.data().estimado,prioridad:e.data().prioridad,showMore:!1,descripcion:e.data().descripcion,pausable:e.data().pausable,tags:e.data().etiquetas,h_inicio:e.data().h_inicio};t.tasks_realizadas.push(a),t.tasks_realizadas.sort(function(t,e){return e.prioridad-t.prioridad||t.id-e.id})})})},computed:{filteredTemplates:function(){var t=this;return this.templates.filter(function(e){return e.titulo.toLowerCase().match(t.searchWord.toLowerCase())})},filteredOperarios:function(){var t=this;return this.operarios.filter(function(e){return e.apellidos.toLowerCase().match(t.searchWordOperario.toLowerCase())})},filteredFinalizadas:function(){var t=this;return this.tasks_realizadas.filter(function(e){return e.titulo.toLowerCase().match(t.searchWordFinalizadas.toLowerCase())})}},methods:{querySearch:function(t,e){var a=this.tagRecomendations;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelectTag:function(t){this.handleInputConfirm()},handleSelectTagOp:function(t){this.handleInputConfirmOp()},loadTags:function(){var t=[];return q.collection("etiquetas").get().then(function(e){e.forEach(function(e){var a={value:e.data().tag};t.push(a)})}),t},createTemplate:function(t){t.preventDefault(),this.frmP_titulo?this.frmP_estimado?isNaN(this.frmP_estimado)?alert("El tiempo estimado debe ser un número entero"):(this.nuevaPlantillaVisible=!1,this.persistData()):alert("El tiempo estimado no puede estar vacío"):alert("El título de la plantilla no puede estar vacío")},editTemplate:function(t){t.preventDefault(),this.frmP_titulo?this.frmP_estimado?isNaN(this.frmP_estimado)?alert("El tiempo estimado debe ser un número entero"):(this.dialogEditVisible=!1,this.updateTemplate(this.id)):alert("El tiempo estimado no puede estar vacío"):alert("El título de la plantilla no puede estar vacío")},fillData:function(t){var e=this;q.collection("plantillas").doc(t.toString()).get().then(function(t){e.frmP_operario=t.data().operario,e.frmP_asignable=t.data().asignable,e.frmP_titulo=t.data().titulo,e.frmP_descripcion=t.data().descripcion,e.frmP_estimado=t.data().estimado,e.frmP_prioridad=t.data().prioridad,e.frmP_pausable=t.data().pausable,e.frmP_etiquetas=t.data().etiquetas,e.id=t.id}).catch(function(t){console.log("Error gettings document:",t)})},fillDataOp:function(t){var e=this;q.collection("operarios").doc(t.toString()).get().then(function(t){e.frmO_nombre=t.data().nombre,e.frmO_apellidos=t.data().apellidos,e.id=t.data().id,e.frmO_etiquetas=t.data().etiquetas}).catch(function(t){console.log("Error gettings document:",t)})},updateTemplate:function(t){var e=this;return q.collection("plantillas").doc(t.toString()).update({descripcion:this.frmP_descripcion,estimado:parseInt(this.frmP_estimado),etiquetas:this.frmP_etiquetas,pausable:this.frmP_pausable,prioridad:this.frmP_prioridad,titulo:this.frmP_titulo}).then(function(){console.log("Plantilla actualizada con éxito!")}).then(function(){e.handleEdit(t)}).catch(function(t){console.error("Error actualizando la plantilla: ",t)})},persistData:function(){var t,e=this,a=q.collection("autoIncrems").doc("plantillas");q.runTransaction((t=f()(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.get(a).then(function(t){var s=t.data().plantillas+1;e.id=s,q.collection("plantillas").doc(s.toString()).set({asignable:!0,descripcion:e.frmP_descripcion,estimado:parseInt(e.frmP_estimado),etiquetas:e.frmP_etiquetas,pausable:e.frmP_pausable,prioridad:e.frmP_prioridad,titulo:e.frmP_titulo,id:s}).then(function(t){console.log("Plantilla añadida a FireBase!");for(var a=0;a<e.frmP_etiquetas.length;a++){var i=e.frmP_etiquetas[a].toString();e.persistTag(i)}}).then(function(){e.handleSubmit()}).catch(function(t){console.error("Error añadiendo la plantilla!",t)}),i.update(a,{plantillas:s})}));case 1:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},deleteTemplate:function(t){var e=this;if(confirm("¿Estas seguro que quieres borrar la plantilla con ID: "+t+" ?")){var a=[];return q.collection("plantillas").doc(t.toString()).get().then(function(t){a=t.data().etiquetas;for(var i=0;i<a.length;i++)e.decreaseTag(a[i])}).then(function(a){q.collection("plantillas").doc(t.toString()).delete().then(function(){console.log("Plantilla borrada con éxito!")}).catch(function(t){console.error("Error borrando plantilla!: ",t)}),e.removeFromModel(t)})}},removeFromModel:function(t){var e=-1,a=0;this.templates.forEach(function(i){i.id==t&&(e=a),a++}),this.templates.splice(e,1)},removeFromModelOp:function(t){var e=-1,a=0;this.operarios.forEach(function(i){i.id==t&&(e=a),a++}),this.operarios.splice(e,1)},decreaseTag:function(t){var e=q.collection("etiquetas").doc(t);return e.get().then(function(t){var a=t.data().veces;console.log(a),a>1?e.update({veces:a-1}):e.delete().then(function(){console.log("Etiqueta borrada con éxito!")}).catch(function(t){console.error("Error borrando etiqueta!: ",t)})})},persistTag:function(t){var e=this,a=q.collection("etiquetas").doc(t);a.get().then(function(i){if(i.exists)a.set({tag:t,veces:i.data().veces+1}).then(function(e){console.log("Etiqueta incrementada en FireBase!: "+t)});else a.set({tag:t,veces:1}).then(function(a){console.log("Nueva etiqueta añadida a FireBase!: "+t),e.tagRecomendations=e.loadTags()}).catch(function(e){console.error("Error añadiendo la etiqueta!: "+t,e)})}).catch(function(t){console.log("Error getting document",t)})},handleEdit:function(t){var e=0;for(e=0;e<this.templates.length;e++)this.templates[e].id==t&&(this.templates[e].titulo=this.frmP_titulo,this.templates[e].operario=this.frmP_operario,this.templates[e].pausable=this.frmP_pausable,this.templates[e].prioridad=this.frmP_prioridad,this.templates[e].estimado=this.frmP_estimado,this.templates[e].descripcion=this.frmP_descripcion,this.templates[e].etiquetas=this.frmP_etiquetas);this.dialogEditVisible=!1,this.cleanForm()},handleSubmit:function(){this.templates.push({titulo:this.frmP_titulo,operario:"",duracion:0,estimado:parseInt(this.frmP_estimado),id:this.id}),this.nuevaPlantillaVisible=!1,this.cleanForm()},handleClose:function(t){this.frmP_etiquetas.splice(this.frmP_etiquetas.indexOf(t),1)},handleCloseO:function(t){this.frmO_etiquetas.splice(this.frmO_etiquetas.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},showInputOp:function(){var t=this;this.inputVisibleOp=!0,this.$nextTick(function(e){t.$refs.saveTagInputOp.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&this.frmP_etiquetas.push(t),this.inputVisible=!1,this.inputValue=""},handleInputConfirmOp:function(){var t=this.inputValueOp;t&&this.frmO_etiquetas.push(t),this.inputVisibleOp=!1,this.inputValueOp=""},cleanForm:function(){this.frmP_titulo="",this.frmP_descripcion="",this.frmP_estimado="",this.frmP_prioridad=200,this.frmP_pausable=!1,this.frmP_etiquetas=[],this.id=""},cleanFormOperarios:function(){this.frmO_nombre="",this.frmO_apellidos="",this.frmO_pass="",this.frmO_pass_2="",this.id="",this.frmO_etiquetas=[]},createWorker:function(t){t.preventDefault(),this.frmO_nombre?this.frmO_apellidos?this.frmO_pass?this.frmO_pass_2?this.frmO_pass!=this.frmO_pass_2?alert("Las contraseñas no coinciden"):isNaN(this.frmO_pass)?alert("El Password ha de ser numérico"):(this.operariosVisible=!1,this.persistDataOperario()):alert("Se requiere confirmación de Password"):alert("Se requiere un Password"):alert("Los apellidos no puden estar vacios"):alert("El nombre no puede estar vacío")},editWorker:function(t){t.preventDefault(),this.frm_nombre?this.frm_apellidos?this.frm_pass?isNaN(this.frm_pass)?alert("El Password ha de ser numérico"):(this.dialogEditVisible=!1,this.updateEmployee(this.id)):alert("Se requiere un Password"):alert("Los apellidos no pueden estar vacios"):alert("El nombre no puede estar vacío")},persistDataOperario:function(){var t,e=this,a=q.collection("autoIncrems").doc("operarios");q.runTransaction((t=f()(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.get(a).then(function(t){var s=t.data().operarios+1;e.id=s,q.collection("operarios").doc(s.toString()).set({nombre:e.frmO_nombre,apellidos:e.frmO_apellidos,etiquetas:e.frmO_etiquetas,pass:e.frmO_pass,id:s,conectado:!1,tareas:[]}).then(function(t){console.log("Operario añadido a FireBase!");for(var a=0;a<e.frmO_etiquetas.length;a++){var i=e.frmO_etiquetas[a].toString();e.persistTag(i)}}).then(function(){e.cleanFormOperarios()}).catch(function(t){console.error("Error añadiendo el operario!",t)}),i.update(a,{operarios:s})}));case 1:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},deleteWorker:function(t){var e=this;if(confirm("¿Estas seguro que quieres borrar el operario con ID: "+t+" ?")){var a=[];return q.collection("operarios").doc(t.toString()).get().then(function(t){a=t.data().etiquetas;for(var i=0;i<a.length;i++)e.decreaseTag(a[i])}).then(function(a){q.collection("operarios").doc(t.toString()).delete().then(function(){console.log("Operario borrado con éxito!")}).catch(function(t){console.error("Error borrando operario!: ",t)}),e.removeFromModelOp(t)})}}},mounted:function(){this.tagRecomendations=this.loadTags()},components:{ButtonGroup:x.a,Navbar:b,Task:w,Worker:C,"bootstrap-modal":a("7RDO"),InputTag:O.a}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"gOperarios"}},[a("Navbar"),t._v(" "),a("div",{staticClass:"wn-col col-pendientes"},[a("div",{staticClass:"wn-col-title"},[t._v("Plantillas\n      "),t.searchVisible?t._e():a("el-button",{staticClass:"wn-menu-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){t.searchVisible=!0}}},[t._v("Abrir")]),t._v(" "),t.searchVisible?a("el-button",{staticClass:"wn-menu-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){t.searchVisible=!1,t.searchWord=""}}},[t._v("Cerrar")]):t._e(),t._v(" "),a("el-button",{staticClass:"wn-menu-btn",on:{click:function(e){t.nuevaPlantillaVisible=!0}}},[t._v("Crear nueva")])],1),t._v(" "),a("div",{staticClass:"table-width"},[a("transition",{attrs:{name:"bounce"}},[t.searchVisible?a("b-input-group",{staticClass:"fondo-buscador"},[a("b-form",{attrs:{inline:""}},[a("i",{staticClass:"material-icons prefix"},[t._v("search")]),t._v(" "),a("b-input",{staticStyle:{width:"300px","margin-left":"10px","margin-right":"8px"},attrs:{placeholder:"Buscar"},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}}),t._v(" "),a("i",{staticClass:"fa fa-times-circle prefix",attrs:{disabled:!t.searchWord},on:{click:function(e){t.searchWord=""}}})],1)],1):t._e()],1),t._v(" "),a("div",{staticClass:"wn-col-container",class:[t.searchVisible?"searchOn":""]},[t.filteredTemplates.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No se enconcontraron plantillas")])]):t._e(),t._v(" "),t._l(t.filteredTemplates,function(e){return t.filteredTemplates.length>=0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("Task",{attrs:{id:e.id,titulo:e.titulo,operario:e.operario,duracion:e.duracion,estimado:e.estimado,prioridad:e.prioridad,showMore:e.showMore,descripcion:e.descripcion,pausable:e.pausable,tags:e.tags}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.deleteTemplate(e.id)}}},[a("i",{staticClass:"fa fa-close ",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.fillData(e.id),t.dialogEditVisible=!0}}},[a("i",{staticClass:"fa fa-edit ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"Nueva plantilla",visible:t.nuevaPlantillaVisible,width:"65%"},on:{"update:visible":function(e){t.nuevaPlantillaVisible=e}}},[a("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Título:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre de la plantilla"},model:{value:t.frmP_titulo,callback:function(e){t.frmP_titulo=e},expression:"frmP_titulo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Prioridad:",required:""}},[a("el-select",{attrs:{placeholder:"Medio"},model:{value:t.frmP_prioridad,callback:function(e){t.frmP_prioridad=e},expression:"frmP_prioridad"}},t._l(t.prioridades,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"Descripción:",required:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"Descripción de la plantilla"},model:{value:t.frmP_descripcion,callback:function(e){t.frmP_descripcion=e},expression:"frmP_descripcion"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"T. estimado:",required:""}},[a("el-input",{staticStyle:{width:"10%"},attrs:{placeholder:"30"},model:{value:t.frmP_estimado,callback:function(e){t.frmP_estimado=e},expression:"frmP_estimado"}})],1),t._v(" "),a("el-switch",{attrs:{"active-text":"Pausable"},model:{value:t.frmP_pausable,callback:function(e){t.frmP_pausable=e},expression:"frmP_pausable"}}),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frmP_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.nuevaPlantillaVisible=!1}}},[t._v("Cancel")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createTemplate}},[t._v("Confirm")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Editar plantilla",visible:t.dialogEditVisible,width:"65%"},on:{"update:visible":function(e){t.dialogEditVisible=e}}},[a("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Título:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre de la plantilla"},model:{value:t.frmP_titulo,callback:function(e){t.frmP_titulo=e},expression:"frmP_titulo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Prioridad:",required:""}},[a("el-select",{attrs:{placeholder:"Medio"},model:{value:t.frmP_prioridad,callback:function(e){t.frmP_prioridad=e},expression:"frmP_prioridad"}},t._l(t.prioridades,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"Descripción:",required:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"Descripción de la tarea"},model:{value:t.frmP_descripcion,callback:function(e){t.frmP_descripcion=e},expression:"frmP_descripcion"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"T. estimado:",required:""}},[a("el-input",{staticStyle:{width:"10%"},attrs:{placeholder:"30"},model:{value:t.frmP_estimado,callback:function(e){t.frmP_estimado=e},expression:"frmP_estimado"}})],1),t._v(" "),a("el-switch",{attrs:{"active-text":"Pausable"},model:{value:t.frmP_pausable,callback:function(e){t.frmP_pausable=e},expression:"frmP_pausable"}}),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frmP_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogEditVisible=!1}}},[t._v("Cancel")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.editTemplate}},[t._v("Confirm")])],1)],1),t._v(" "),a("div",{staticClass:"wn-col col-asignadas"},[a("div",{staticClass:"wn-col-title "},[t._v("Operarios\n      "),t.searchVisibleOperario?t._e():a("el-button",{staticClass:"wn-menu-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){t.searchVisibleOperario=!0}}},[t._v("Abrir")]),t._v(" "),t.searchVisibleOperario?a("el-button",{staticClass:"wn-menu-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){t.searchVisibleOperario=!1,t.searchWordOperario=""}}},[t._v("Cerrar")]):t._e(),t._v(" "),a("el-button",{staticClass:"wn-menu-btn",on:{click:function(e){t.inputVisible=!1,t.cleanFormOperarios(),t.operariosVisible=!0}}},[t._v("Crear nuevo")])],1),t._v(" "),a("div",{staticClass:"table-width"},[a("transition",{attrs:{name:"bounce"}},[t.searchVisibleOperario?a("b-input-group",{staticClass:"fondo-buscador"},[a("b-form",{attrs:{inline:""}},[a("i",{staticClass:"material-icons prefix"},[t._v("search")]),t._v(" "),a("b-input",{staticStyle:{width:"300px","margin-left":"10px","margin-right":"8px"},attrs:{placeholder:"Buscar"},model:{value:t.searchWordOperario,callback:function(e){t.searchWordOperario=e},expression:"searchWordOperario"}}),t._v(" "),a("i",{staticClass:"fa fa-times-circle prefix",attrs:{disabled:!t.searchWordOperario},on:{click:function(e){t.searchWordOperario=""}}})],1)],1):t._e()],1),t._v(" "),a("div",{staticClass:"wn-col-container",class:[t.searchVisibleOperario?"searchOn":""]},[t.filteredOperarios.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No se enconcontraron operarios")])]):t._e(),t._v(" "),t._l(t.filteredOperarios,function(e){return t.filteredOperarios.length>0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("Worker",{attrs:{id:e.id,nombre:e.nombre,apellidos:e.apellidos,tags:e.tags,"show-more":e.showMore,conectado:e.conectado}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.deleteWorker(e.id)}}},[a("i",{staticClass:"fa fa-close ",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.inputVisible=!1,t.fillDataOp(e.id),t.operariosEditVisible=!0}}},[a("i",{staticClass:"fa fa-edit ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"Alta nuevo operario",visible:t.operariosVisible,width:"65%"},on:{"update:visible":function(e){t.operariosVisible=e}}},[a("el-form",{ref:"modal_new_worker",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Nombre:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre del operario"},model:{value:t.frmO_nombre,callback:function(e){t.frmO_nombre=e},expression:"frmO_nombre"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Apellidos:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Apellidos del operario"},model:{value:t.frmO_apellidos,callback:function(e){t.frmO_apellidos=e},expression:"frmO_apellidos"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Contraseña:",required:""}},[a("el-input",{attrs:{type:"password",placeholder:"123456"},model:{value:t.frmO_pass,callback:function(e){t.frmO_pass=e},expression:"frmO_pass"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Repetir contraseña:",required:""}},[a("el-input",{attrs:{type:"password",placeholder:"123456"},model:{value:t.frmO_pass_2,callback:function(e){t.frmO_pass_2=e},expression:"frmO_pass_2"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frmO_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleCloseO(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisibleOp?a("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"23%","font-size":"10px"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta","eyup.enter.native":"handleInputConfirmOp"},on:{k:function(t){},select:t.handleSelectTagOp},model:{value:t.inputValueOp,callback:function(e){t.inputValueOp=e},expression:"inputValueOp"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInputOp}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.operariosVisible=!1}}},[t._v("Cancelar")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createWorker}},[t._v("Crear")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Editar operario",visible:t.operariosEditVisible,width:"65%"},on:{"update:visible":function(e){t.operariosEditVisible=e}}},[a("el-form",{ref:"modal_edit_worker",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Nombre:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre del operario"},model:{value:t.frmO_nombre,callback:function(e){t.frmO_nombre=e},expression:"frmO_nombre"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Apellidos:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Apellidos del operario"},model:{value:t.frmO_apellidos,callback:function(e){t.frmO_apellidos=e},expression:"frmO_apellidos"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Contraseña:",required:""}},[a("el-input",{attrs:{type:"password",placeholder:"123456"},model:{value:t.frmO_pass,callback:function(e){t.frmO_pass=e},expression:"frmO_pass"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frmO_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleCloseO(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisibleOp?a("el-autocomplete",{ref:"saveTagInputOp",staticClass:"input-new-tag",staticStyle:{width:"23%","font-size":"10px"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTagOp},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirmOp(e):null}},model:{value:t.inputValueOp,callback:function(e){t.inputValueOp=e},expression:"inputValueOp"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInputOp}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.operariosEditVisible=!1}}},[t._v("Cancelar")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.editWorker}},[t._v("Guardar")])],1)],1),t._v(" "),a("div",{staticClass:"wn-col col-realizadas"},[a("div",{staticClass:"wn-col-title "},[t._v("Histórico de tareas\n      "),t.searchVisibleFinalizadas?t._e():a("el-button",{staticClass:"wn-menu-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){t.searchVisibleFinalizadas=!0}}},[t._v("Abrir")]),t._v(" "),t.searchVisibleFinalizadas?a("el-button",{staticClass:"wn-menu-btn",attrs:{icon:"el-icon-search"},on:{click:function(e){t.searchVisibleFinalizadas=!1,t.searchWordFinalizadas=""}}},[t._v("Cerrar")]):t._e()],1),t._v(" "),a("div",{staticClass:"table-width"},[a("transition",{attrs:{name:"bounce"}},[t.searchVisibleFinalizadas?a("b-input-group",{staticClass:"fondo-buscador"},[a("b-form",{attrs:{inline:""}},[a("i",{staticClass:"material-icons prefix"},[t._v("search")]),t._v(" "),a("b-input",{staticStyle:{width:"300px","margin-left":"10px","margin-right":"8px"},attrs:{placeholder:"Buscar"},model:{value:t.searchWordFinalizadas,callback:function(e){t.searchWordFinalizadas=e},expression:"searchWordFinalizadas"}}),t._v(" "),a("i",{staticClass:"fa fa-times-circle prefix",attrs:{disabled:!t.searchWordFinalizadas},on:{click:function(e){t.searchWordFinalizadas=""}}})],1)],1):t._e()],1),t._v(" "),a("div",{staticClass:"wn-col-container",class:[t.searchVisibleFinalizadas?"searchOn":""]},[t.filteredFinalizadas.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No se encontraron tareas finalizadas")])]):t._e(),t._v(" "),t._l(t.filteredFinalizadas,function(e){return t.filteredFinalizadas.length>0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("Task",{attrs:{id:e.id,titulo:e.titulo,operario:e.operario,duracion:e.duracion,estimado:e.estimado,prioridad:e.prioridad,showMore:e.showMore,descripcion:e.descripcion,pausable:e.pausable,tags:e.tags,h_inicio:e.h_inicio}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2)],1)])],1)},staticRenderFns:[]};var P=a("VU/8")(V,E,!1,function(t){a("qK2r")},null,null).exports,T={name:"task",props:["id","titulo","operario","estimado","prioridad","showMore","descripcion","pausable","tags","h_inicio"],data:function(){return{h_actual:(new Date).getTime(),h_obtenida:this.h_inicio.getTime(),duracion:Math.round((this.h_actual-this.h_obtenida)/6e4)}},mounted:function(){this.updateDateTime,setInterval(this.updateDateTime,1e3)},methods:{updateDateTime:function(){var t=(new Date).getTime(),e=this.h_inicio.getTime(),a=Math.round((t-e)/6e4);this.duracion=a}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wn-task-data"},[a("h3",[400==this.prioridad?a("i",{staticClass:"fa fa-angle-double-up hot-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),300==this.prioridad?a("i",{staticClass:"fa fa-angle-up hot-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),200==this.prioridad?a("i",{staticClass:"fa fa-angle-up mid-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),100==this.prioridad?a("i",{staticClass:"fa fa-angle-down low-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),0==this.prioridad?a("i",{staticClass:"fa fa-angle-double-down muy-low-icon",attrs:{"aria-hidden":"true"}}):t._e(),t._v("\n      "+t._s(this.titulo)+"\n    ")]),t._v(" "),a("p",[a("b",[t._v("Operario:")]),t._v("  "+t._s(this.operario))]),t._v(" "),a("p",[a("b",[t._v("Duración:")]),t._v(" "),this.duracion<=this.estimado?a("span",[t._v(t._s(this.duracion))]):t._e(),t._v(" "),this.duracion>this.estimado&&this.duracion<2*this.estimado?a("span",{staticStyle:{color:"darkorange"}},[t._v(t._s(this.duracion))]):t._e(),t._v(" "),this.duracion>2*this.estimado?a("span",{staticStyle:{color:"red"}},[t._v(t._s(this.duracion))]):t._e(),t._v("\n      / "+t._s(this.estimado)+" min")]),t._v(" "),t.showMore?a("div",{staticClass:"more-info"},[a("p",[a("b",[t._v("Id:")]),t._v(" "+t._s(this.id))]),t._v(" "),a("p",[a("b",[t._v("Pausable:")]),t._v(" "+t._s(this.pausable))]),t._v(" "),a("p",[a("b",[t._v("Descipción:")]),t._v("  "+t._s(this.descripcion))]),t._v(" "),t._m(0),t._v(" "),t._l(this.tags,function(e){return a("div",{staticClass:"el-tag"},[a("p",[t._v(t._s(e))])])}),t._v(" "),0==this.tags.length?a("p",[t._v("No hay etiquetas asignadas")]):t._e()],2):t._e(),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("b",[this._v("Etiquetas:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"end-line"},[e("p")])}]};var N=a("VU/8")(T,S,!1,function(t){a("a91A")},"data-v-f70a9ff4",null).exports,M={name:"ElContainer",componentName:"ElContainer",props:{direction:String},computed:{isVertical:function(){return"vertical"===this.direction||"horizontal"!==this.direction&&(!(!this.$slots||!this.$slots.default)&&this.$slots.default.some(function(t){var e=t.componentOptions&&t.componentOptions.tag;return"el-header"===e||"el-footer"===e}))}}},z={render:function(){var t=this.$createElement;return(this._self._c||t)("section",{staticClass:"el-container",class:{"is-vertical":this.isVertical}},[this._t("default")],2)},staticRenderFns:[]},F={name:"dashboard",data:function(){return{dialogVisible:!1,dialogEditVisible:!1,templates:[],tasks_sin_asignar:[],tasks_asignadas:[],tasks_realizadas:[],operarios:[],frm_operario:"",frm_fechaRealizacion:"",frm_asignable:!0,frm_titulo:"",frm_descripcion:"",frm_estimado:"",frm_prioridad:200,frm_pausable:!1,frm_etiquetas:[],rst_operario:"",rst_fechaRealizacion:"",rst_asignable:!0,rst_titulo:"",rst_descripcion:"",rst_estimado:"",rst_prioridad:200,rst_pausable:!1,rst_etiquetas:[],prioridades:[{value:400,text:"Urgente"},{value:300,text:"Alta"},{value:200,text:"Media"},{value:100,text:"Baja"},{value:0,text:"Muy baja"}],tagRecomendations:[],inputVisible:!1,inputValue:"",id:"",loading:!0,searchWord:"",currentRow:null}},created:function(){var t=this;q.collection("sinAsignar").onSnapshot(function(e){t.tasks_sin_asignar.length=0,e.docs.map(function(e){var a={id:e.id,operario:"Se asignará durante la ejecución",titulo:e.data().titulo,duracion:0,estimado:e.data().estimado,prioridad:e.data().prioridad,showMore:!1,descripcion:e.data().descripcion,pausable:e.data().pausable,tags:e.data().etiquetas,asignable:e.data().asignable,h_inicio:e.data().h_inicio};a.asignable&&(console.log("entra_sin_asignar"),t.tasks_sin_asignar.push(a),t.tasks_sin_asignar.sort(function(t,e){return e.prioridad-t.prioridad||t.id-e.id}))})}),q.collection("asignadas").onSnapshot(function(e){t.tasks_asignadas.length=0,e.docs.map(function(e){var a={id:e.id,operario:e.data().operario,titulo:e.data().titulo,duracion:0,estimado:e.data().estimado,prioridad:e.data().prioridad,showMore:!1,descripcion:e.data().descripcion,pausable:e.data().pausable,tags:e.data().etiquetas,aceptada:e.data().aceptada,h_inicio:e.data().h_inicio};a.aceptada&&(console.log("entra_aceptada"),t.tasks_asignadas.push(a)),t.tasks_asignadas.sort(function(t,e){return e.prioridad-t.prioridad||t.id-e.id})})}),q.collection("finalizadas").onSnapshot(function(e){t.tasks_realizadas.length=0,e.forEach(function(e){var a={id:e.id,operario:e.data().operario,titulo:e.data().titulo,estimado:e.data().estimado,prioridad:e.data().prioridad,showMore:!1,descripcion:e.data().descripcion,pausable:e.data().pausable,tags:e.data().etiquetas,h_inicio:e.data().h_inicio};console.log("entra_finalizada"),t.tasks_realizadas.push(a),t.tasks_realizadas.sort(function(t,e){return e.prioridad-t.prioridad||t.id-e.id})})}),q.collection("operarios").onSnapshot(function(e){t.loading=!1,t.operarios=[],e.forEach(function(e){if(console.log("evalua"),e.data().conectado){var a={nombre:e.data().nombre,apellidos:e.data().apellidos,pass:e.data().pass,id:e.id,tags:e.data().etiquetas,showMore:!1,conectado:e.data().conectado};console.log("nombre: "+a.nombre+" CONN"),t.operarios.push(a)}})}),this.fillTemplates()},computed:{filteredTemplates:function(){var t=this;return this.templates.filter(function(e){return e.titulo.toLowerCase().match(t.searchWord.toLowerCase())})},filteredOperarios:function(){return this.operarios.filter(function(t){return 1==t.conectado})}},methods:{resetFields:function(){this.frm_operario=this.rst_operario,this.frm_asignable=this.rst_asignable,this.frm_titulo=this.rst_titulo,this.frm_descripcion=this.rst_descripcion,this.frm_estimado=this.rst_estimado,this.frm_prioridad=this.rst_prioridad,this.frm_pausable=this.rst_pausable,this.frm_etiquetas=this.rst_etiquetas.slice(),this.frm_fechaRealizacion=this.rst_fechaRealizacion},clearFields:function(){this.cleanForm()},fillTemplates:function(){var t=this;q.collection("plantillas").orderBy("titulo").get().then(function(e){t.loading=!1,e.forEach(function(e){var a={id:e.id,titulo:e.data().titulo};t.templates.push(a)})})},fillModal:function(t){},handleCurrentChange:function(t){this.fillDataFromTemplate(t.id),this.currentRow=t},querySearch:function(t,e){var a=this.tagRecomendations;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelectTag:function(t){this.handleInputConfirm()},loadTags:function(){var t=[];return q.collection("etiquetas").get().then(function(e){e.forEach(function(e){var a={value:e.data().tag};t.push(a)})}),t},createTask:function(t){t.preventDefault(),this.frm_titulo?this.frm_estimado?isNaN(this.frm_estimado)?alert("El tiempo estimado debe ser un número entero"):(this.dialogVisible=!1,this.persistData()):alert("El tiempo estimado no puede estar vacío"):alert("El título no puede estar vacío")},editTask:function(t){t.preventDefault(),this.frm_titulo?this.frm_estimado?isNaN(this.frm_estimado)?alert("El tiempo estimado debe ser un número entero"):(this.dialogEditVisible=!1,this.updateTask(this.id)):alert("El tiempo estimado no puede estar vacío"):alert("El título no puede estar vacío")},fillData:function(t){var e=this;q.collection("sinAsignar").doc(t.toString()).get().then(function(t){e.frm_operario="Se asignará durante la ejecución",e.frm_asignable=t.data().asignable,e.frm_titulo=t.data().titulo,e.frm_descripcion=t.data().descripcion,e.frm_estimado=t.data().estimado,e.frm_prioridad=t.data().prioridad,e.frm_pausable=t.data().pausable,e.frm_etiquetas=t.data().etiquetas,e.frm_fechaRealizacion=t.data().fecha_realizacion,e.id=t.id,e.frm_operario="Se asignará durante la ejecución",e.rst_asignable=t.data().asignable,e.rst_titulo=t.data().titulo,e.rst_descripcion=t.data().descripcion,e.rst_estimado=t.data().estimado,e.rst_prioridad=t.data().prioridad,e.rst_pausable=t.data().pausable,e.rst_etiquetas=t.data().etiquetas,e.rst_fechaRealizacion=t.data().fecha_realizacion}).catch(function(t){console.log("Error getting document:",t)})},fillDataFromTemplate:function(t){var e=this;q.collection("plantillas").doc(t.toString()).get().then(function(t){e.frm_operario=t.data().operario,e.frm_asignable=t.data().asignable,e.frm_titulo=t.data().titulo,e.frm_descripcion=t.data().descripcion,e.frm_estimado=t.data().estimado,e.frm_prioridad=t.data().prioridad,e.frm_pausable=t.data().pausable,e.frm_etiquetas=t.data().etiquetas,e.frm_fechaRealizacion=t.data().fecha_realizacion,e.id=t.id}).catch(function(t){console.log("Error gettings document:",t)})},updateTask:function(t){var e=this;return q.collection("sinAsignar").doc(t.toString()).update({descripcion:this.frm_descripcion,estimado:parseInt(this.frm_estimado),etiquetas:this.frm_etiquetas,pausable:this.frm_pausable,prioridad:this.frm_prioridad,titulo:this.frm_titulo}).then(function(){console.log("Tarea actualizada con éxito!")}).then(function(){e.handleEdit(t)}).catch(function(t){console.error("Error actualizando la tarea: ",t)})},persistData:function(){var t,e=this,a=q.collection("autoIncrems").doc("tareas");q.runTransaction((t=f()(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.get(a).then(function(t){var s=t.data().tareas+1;e.id=s,q.collection("sinAsignar").doc(s.toString()).set({asignable:!0,descripcion:e.frm_descripcion,estimado:parseInt(e.frm_estimado),etiquetas:e.frm_etiquetas,fecha_realizacion:new Date,pausable:e.frm_pausable,prioridad:e.frm_prioridad,titulo:e.frm_titulo,h_inicio:new Date(0),h_fin:new Date(0),satisfaccion:0,id:s,operario:0,aceptada:!1}).then(function(t){console.log("Tarea añadida a FireBase!");for(var a=0;a<e.frm_etiquetas.length;a++){var i=e.frm_etiquetas[a].toString();e.persistTag(i)}}).then(function(){e.handleSubmit()}).catch(function(t){console.error("Error añadiendo la tarea!",t)}),i.update(a,{tareas:s})}));case 1:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},deleteTask:function(t){var e=this;if(confirm("¿Estas seguro que quieres borrar la tarea con ID: "+t+" ?")){var a=[];return q.collection("sinAsignar").doc(t.toString()).get().then(function(t){a=t.data().etiquetas;for(var i=0;i<a.length;i++)e.decreaseTag(a[i])}).then(function(a){q.collection("sinAsignar").doc(t.toString()).delete().then(function(){console.log("Tarea borrada con éxito!")}).catch(function(t){console.error("Error borrando tarea!: ",t)}),e.removeFromModel(t)})}},removeFromModel:function(t){var e=-1,a=0;this.tasks_sin_asignar.forEach(function(i){i.id==t&&(e=a),a++}),this.tasks_sin_asignar.splice(e,1)},decreaseTag:function(t){var e=q.collection("etiquetas").doc(t);return e.get().then(function(t){var a=t.data().veces;console.log(a),a>1?e.update({veces:a-1}):e.delete().then(function(){console.log("Etiqueta borrada con éxito!")}).catch(function(t){console.error("Error borrando etiqueta!: ",t)})})},persistTag:function(t){var e=this,a=q.collection("etiquetas").doc(t);a.get().then(function(i){if(i.exists)a.set({tag:t,veces:i.data().veces+1}).then(function(e){console.log("Etiqueta incrementada en FireBase!: "+t)});else a.set({tag:t,veces:1}).then(function(a){console.log("Nueva etiqueta añadida a FireBase!: "+t),e.tagRecomendations=e.loadTags()}).catch(function(e){console.error("Error añadiendo la etiqueta!: "+t,e)})}).catch(function(t){console.log("Error getting document",t)})},handleEdit:function(t){var e=0;for(e=0;e<this.tasks_sin_asignar.length;e++)this.tasks_sin_asignar[e].id==t&&(this.tasks_sin_asignar[e].titulo=this.frm_titulo,this.tasks_sin_asignar[e].operario=this.frm_operario,this.tasks_sin_asignar[e].pausable=this.frm_pausable,this.tasks_sin_asignar[e].prioridad=this.frm_prioridad,this.tasks_sin_asignar[e].estimado=this.frm_estimado,this.tasks_sin_asignar[e].descripcion=this.frm_descripcion,this.tasks_sin_asignar[e].etiquetas=this.frm_etiquetas);this.dialogEditVisible=!1,this.cleanForm()},handleSubmit:function(){this.dialogVisible=!1,this.cleanForm()},handleClose:function(t){this.frm_etiquetas.splice(this.frm_etiquetas.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&this.frm_etiquetas.push(t),this.inputVisible=!1,this.inputValue=""},cleanForm:function(){this.frm_titulo="",this.frm_descripcion="",this.frm_estimado="",this.frm_prioridad=200,this.frm_pausable=!1,this.frm_etiquetas=[],this.id=""}},mounted:function(){this.tagRecomendations=this.loadTags()},components:{ElContainer:a("VU/8")(M,z,!1,null,null,null).exports,ButtonGroup:x.a,Navbar:b,Task:w,TaskActiva:N,Worker:C,"bootstrap-modal":a("7RDO"),InputTag:O.a}},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"dashboard"}},[a("Navbar"),t._v(" "),a("div",{staticClass:"wn-col col-pendientes"},[a("div",{staticClass:"wn-col-title"},[t._v("Tareas sin asignar\n      "),a("el-button",{staticClass:"wn-menu-btn",on:{click:function(e){t.cleanForm(),t.dialogVisible=!0}}},[t._v("Nueva tarea")])],1),t._v(" "),a("div",{staticClass:"wn-col-container scrollbar"},[t.tasks_sin_asignar.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No hay tareas por asignar")])]):t._e(),t._v(" "),t._l(t.tasks_sin_asignar,function(e){return t.tasks_sin_asignar.length>0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("Task",{attrs:{id:e.id,titulo:e.titulo,operario:e.operario,duracion:e.duracion,estimado:e.estimado,prioridad:e.prioridad,showMore:e.showMore,descripcion:e.descripcion,pausable:e.pausable,tags:e.tags,h_inicio:e.h_inicio}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.deleteTask(e.id)}}},[a("i",{staticClass:"fa fa-close ",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.fillData(e.id),t.dialogEditVisible=!0}}},[a("i",{staticClass:"fa fa-edit ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2)]),t._v(" "),a("div",{staticClass:"wn-col col-asignadas"},[a("div",{staticClass:"wn-col-title"},[t._v("Tareas asignadas")]),t._v(" "),a("div",{staticClass:"wn-col-container"},[t.tasks_asignadas.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No hay tareas asignadas")])]):t._e(),t._v(" "),t._l(t.tasks_asignadas,function(e){return t.tasks_asignadas.length>0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("TaskActiva",{attrs:{id:e.id,titulo:e.titulo,operario:e.operario,duracion:e.duracion,estimado:e.estimado,prioridad:e.prioridad,showMore:e.showMore,descripcion:e.descripcion,pausable:e.pausable,tags:e.tags,h_inicio:e.h_inicio}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2)]),t._v(" "),a("div",{staticClass:"wn-col col-realizadas"},[a("div",{staticClass:"wn-col-title"},[t._v("Tareas finalizadas")]),t._v(" "),a("div",{staticClass:"wn-col-container-mid",staticStyle:{"border-bottom":"solid 3px white",height:"254px"}},[t.tasks_realizadas.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No se finalizaron tareas hoy")])]):t._e(),t._v(" "),t._l(t.tasks_realizadas,function(e){return t.tasks_realizadas.length>0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("Task",{attrs:{id:e.id,titulo:e.titulo,operario:e.operario,duracion:e.duracion,estimado:e.estimado,prioridad:e.prioridad,showMore:e.showMore,descripcion:e.descripcion,pausable:e.pausable,tags:e.tags,h_inicio:e.h_inicio}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2),t._v(" "),a("div",{staticClass:"wn-col-title "},[t._v("Operarios conectados")]),t._v(" "),a("div",{staticClass:"wn-col-container-mid"},[t.operarios.length<=0?a("div",[a("p",{staticClass:"informacion"},[t._v("No hay operarios conectados")])]):t._e(),t._v(" "),t._l(t.filteredOperarios,function(e){return t.operarios.length>0?a("div",{key:e.id,staticClass:"wn-task-container"},[a("Worker",{attrs:{id:e.id,nombre:e.nombre,apellidos:e.apellidos,tags:e.tags,"show-more":e.showMore,conectado:e.conectado}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1):t._e()})],2)]),t._v(" "),a("el-dialog",{attrs:{title:"Nueva tarea",visible:t.dialogVisible,width:"65%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-container",[a("el-aside",{staticClass:"modal-col-plantillas",attrs:{width:"22%"}},[a("b-input-group",[a("b-form",{attrs:{inline:""}},[a("i",{staticClass:"material-icons prefix"},[t._v("search")]),t._v(" "),a("b-input",{staticStyle:{width:"120px","margin-left":"10px","margin-right":"8px"},attrs:{placeholder:"Buscar"},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}}),t._v(" "),a("i",{staticClass:"fa fa-times-circle prefix",attrs:{disabled:!t.searchWord},on:{click:function(e){t.searchWord=""}}})],1)],1),t._v(" "),a("el-table",{attrs:{data:t.filteredTemplates,"show-header":!0,height:"480px","max-height":"480px"},on:{"current-change":t.handleCurrentChange}},[a("el-table-column",{staticStyle:{color:"orange"},attrs:{prop:"titulo",label:"Plantillas",width:"180",row:""}})],1)],1),t._v(" "),a("el-container",[a("div",{staticClass:"modal-col-data"},[a("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Título",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre de la tarea"},model:{value:t.frm_titulo,callback:function(e){t.frm_titulo=e},expression:"frm_titulo"}})],1),t._v(" "),a("el-container",[a("el-aside",[a("el-form-item",{attrs:{label:"Prioridad",required:""}},[a("el-select",{attrs:{placeholder:"Medio"},model:{value:t.frm_prioridad,callback:function(e){t.frm_prioridad=e},expression:"frm_prioridad"}},t._l(t.prioridades,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}))],1)],1),t._v(" "),a("el-container",[a("el-form-item",{attrs:{label:"T. estimado",required:""}},[a("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:"30"},model:{value:t.frm_estimado,callback:function(e){t.frm_estimado=e},expression:"frm_estimado"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Descripción",required:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"Descripción de la tarea"},model:{value:t.frm_descripcion,callback:function(e){t.frm_descripcion=e},expression:"frm_descripcion"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas",required:""}},[t._l(t.frm_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n                "+t._s(e)+"\n              ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{staticClass:"input-new-tag",staticStyle:{width:"42%","font-size":"10px"},attrs:{size:"small","fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2),t._v(" "),a("el-switch",{attrs:{"active-text":"Pausable"},model:{value:t.frm_pausable,callback:function(e){t.frm_pausable=e},expression:"frm_pausable"}})],1)],1),t._v(" "),a("el-footer",{staticClass:"modal-footer"},[a("el-button",{on:{click:t.clearFields}},[t._v("Borrar campos")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("Cancelar")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createTask}},[t._v("Confirmar")])],1)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Editar tarea",visible:t.dialogEditVisible,width:"65%"},on:{"update:visible":function(e){t.dialogEditVisible=e}}},[a("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Título:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre de la tarea"},model:{value:t.frm_titulo,callback:function(e){t.frm_titulo=e},expression:"frm_titulo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Prioridad:",required:""}},[a("el-select",{attrs:{placeholder:"Medio"},model:{value:t.frm_prioridad,callback:function(e){t.frm_prioridad=e},expression:"frm_prioridad"}},t._l(t.prioridades,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"Descripción:",required:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"Descripción de la tarea"},model:{value:t.frm_descripcion,callback:function(e){t.frm_descripcion=e},expression:"frm_descripcion"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"T. estimado:",required:""}},[a("el-input",{staticStyle:{width:"10%"},attrs:{placeholder:"30"},model:{value:t.frm_estimado,callback:function(e){t.frm_estimado=e},expression:"frm_estimado"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frm_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"23%","font-size":"10px"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2),t._v(" "),a("el-switch",{attrs:{"active-text":"Pausable"},model:{value:t.frm_pausable,callback:function(e){t.frm_pausable=e},expression:"frm_pausable"}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.resetFields}},[t._v("Restablecer campos")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogEditVisible=!1}}},[t._v("Cancel")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.editTask}},[t._v("Confirm")])],1)],1)],1)},staticRenderFns:[]};var D=a("VU/8")(F,I,!1,function(t){a("sCLF")},null,null).exports,W={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"Nueva tarea",visible:this.dialogVisible,width:"65%"},on:{"update:visible":function(e){t.$set(this,"dialogVisible",e)}}},[a("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Título:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre de la tarea"},model:{value:t.frm_titulo,callback:function(e){t.frm_titulo=e},expression:"frm_titulo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Prioridad:",required:""}},[a("el-select",{attrs:{placeholder:"Medio"},model:{value:t.frm_prioridad,callback:function(e){t.frm_prioridad=e},expression:"frm_prioridad"}},t._l(t.prioridades,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"Descripción:",required:""}},[a("el-input",{attrs:{type:"textarea",placeholder:"Descripción de la tarea"},model:{value:t.frm_descripcion,callback:function(e){t.frm_descripcion=e},expression:"frm_descripcion"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"T. estimado:",required:""}},[a("el-input",{staticStyle:{width:"10%"},attrs:{placeholder:"30"},model:{value:t.frm_estimado,callback:function(e){t.frm_estimado=e},expression:"frm_estimado"}})],1),t._v(" "),a("el-switch",{attrs:{"active-text":"Pausable"},model:{value:t.frm_pausable,callback:function(e){t.frm_pausable=e},expression:"frm_pausable"}}),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frm_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n        "+t._s(e)+"\n      ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{staticClass:"input-new-tag",attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){(!0).dialogVisible=!1}}},[t._v("Cancel")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createTask}},[t._v("Confirm")])],1)],1)},staticRenderFns:[]},L=a("VU/8")({name:"new-task",props:["dialogVisible"]},W,!1,null,null,null).exports,R={name:"gOperarios",data:function(){return{dialogVisible:!1,dialogEditVisible:!1,operarios:[],frm_nombre:"",frm_apellidos:"",frm_pass:"",frm_pass_2:"",frm_conectado:!1,frm_tareas:[],frm_etiquetas:[],id:"",tagRecomendations:[],inputVisible:!1,inputValue:"",conectado:"",loading:!0}},created:function(){var t=this;q.collection("operarios").onSnapshot(function(e){t.loading=!1,t.operarios.length=0,e.forEach(function(e){var a={nombre:e.data().nombre,apellidos:e.data().apellidos,pass:e.data().pass,id:e.id,tags:e.data().etiquetas,showMore:!1,conectado:e.data().conectado};t.operarios.push(a),t.operarios.sort(function(t,e){return!t.conectado&&e.conectado})})})},computed:{filteredOperarios:function(){return this.operarios.filter(function(t){return 1==t.conectado})}},components:{ButtonGroup:x.a,Navbar:b,Worker:C,"bootstrap-modal":a("7RDO"),InputTag:O.a},methods:{createWorker:function(t){t.preventDefault(),this.frm_nombre?this.frm_apellidos?this.frm_pass?this.frm_pass_2?this.frm_pass!=this.frm_pass_2?alert("Las contraseñas no coinciden"):isNaN(this.frm_pass)?alert("El Password ha de ser numérico"):(this.dialogVisible=!1,this.persistData()):alert("Se requiere confirmación de Password"):alert("Se requiere un Password"):alert("Los apellidos no puden estar vacios"):alert("El nombre no puede estar vacío")},fillData:function(t){var e=this;q.collection("operarios").doc(t.toString()).get().then(function(a){e.frm_nombre=a.data().nombre,e.frm_apellidos=a.data().apellidos,e.frm_pass=a.data().pass,e.id=t,e.frm_etiquetas=a.data().etiquetas}).catch(function(t){console.log("Error gettings document:",t)})},editWorker:function(t){t.preventDefault(),this.frm_nombre?this.frm_apellidos?this.frm_pass?isNaN(this.frm_pass)?alert("El Password ha de ser numérico"):(this.dialogEditVisible=!1,this.updateEmployee(this.id)):alert("Se requiere un Password"):alert("Los apellidos no pueden estar vacios"):alert("El nombre no puede estar vacío")},persistDataOperario:function(){var t,e=this,a=q.collection("autoIncrems").doc("operarios");q.runTransaction((t=f()(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.get(a).then(function(t){var s=t.data().operarios+1;e.id=s,q.collection("operarios").doc(s.toString()).set({nombre:e.frm_nombre,apellidos:e.frm_apellidos,etiquetas:e.frm_etiquetas,pass:e.frm_pass,id:s,conectado:!1,tareas:[]}).then(function(t){console.log("Operario añadido a FireBase!");for(var a=0;a<e.frm_etiquetas.length;a++){var i=e.frm_etiquetas[a].toString();e.persistTag(i)}}).then(function(){e.handleSubmit()}).catch(function(t){console.error("Error añadiendo el operario!",t)}),i.update(a,{operarios:s})}));case 1:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},handleSubmit:function(){this.cleanForm()},handleEdit:function(t){var e=0;for(e=0;e<this.operarios.length;e++)this.operarios[e].id==t&&(this.operarios[e].nombre=this.frm_nombre,this.operarios[e].apellidos=this.frm_apellidos,this.operarios[e].pass=this.frm_pass,this.operarios[e].etiquetas=this.frm_etiquetas);this.dialogEditVisible=!1,this.cleanForm()},cleanForm:function(){this.frm_nombre="",this.frm_apellidos="",this.frm_pass="",this.id="",this.frm_etiquetas=[]},removeFromModel:function(t){var e=-1,a=0;this.operarios.forEach(function(i){i.id==t&&(e=a),a++}),this.operarios.splice(e,1)},deleteWorker:function(t){var e=this;if(confirm("¿Estas seguro que quieres borrar el operario con ID: "+t+" ?")){var a=[];return q.collection("operarios").doc(t.toString()).get().then(function(t){a=t.data().etiquetas;for(var i=0;i<a.length;i++)e.decreaseTag(a[i])}).then(function(a){q.collection("operarios").doc(t.toString()).delete().then(function(){console.log("Operario borrado con éxito!")}).catch(function(t){console.error("Error borrando operario!: ",t)}),e.removeFromModel(t)})}},updateEmployee:function(t){var e=this;return q.collection("operarios").doc(t.toString()).update({nombre:this.frm_nombre,apellidos:this.frm_apellidos,pass:this.frm_pass,etiquetas:this.frm_etiquetas}).then(function(){console.log("Operario actualizado con éxito!")}).then(function(){e.handleEdit(e.id)}).catch(function(t){console.error("Error actualizando operario: ",t)})},querySearch:function(t,e){var a=this.tagRecomendations;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelectTag:function(t){this.handleInputConfirm()},loadTags:function(){var t=[];return q.collection("etiquetas").get().then(function(e){e.forEach(function(e){var a={value:e.data().tag};t.push(a)})}),t},decreaseTag:function(t){var e=q.collection("etiquetas").doc(t);return e.get().then(function(t){var a=t.data().veces;console.log(a),a>1?e.update({veces:a-1}):e.delete().then(function(){console.log("Etiqueta borrada con éxito!")}).catch(function(t){console.error("Error borrando etiqueta!: ",t)})})},persistTag:function(t){var e=this,a=q.collection("etiquetas").doc(t);a.get().then(function(i){if(i.exists)a.set({tag:t,veces:i.data().veces+1}).then(function(e){console.log("Etiqueta incrementada en FireBase!: "+t)});else a.set({tag:t,veces:1}).then(function(a){console.log("Nueva etiqueta añadida a FireBase!: "+t),e.tagRecomendations=e.loadTags()}).catch(function(e){console.error("Error añadiendo la etiqueta!: "+t,e)})}).catch(function(t){console.log("Error getting document",t)})},handleClose:function(t){this.frm_etiquetas.splice(this.frm_etiquetas.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&(console.log("input_value:"+t),this.frm_etiquetas.push(t)),this.inputVisible=!1,this.inputValue=""}},mounted:function(){this.tagRecomendations=this.loadTags()}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"gOperarios"}},[a("Navbar"),t._v(" "),a("div",{staticClass:"wn-col col-pendientes"},[a("div",{staticClass:"wn-col-title"},[t._v("Lista Operarios\n      "),a("el-button",{staticClass:"wn-menu-btn",on:{click:function(e){t.inputVisible=!1,t.cleanForm(),t.dialogVisible=!0}}},[t._v("Crear nuevo")])],1),t._v(" "),a("div",{staticClass:"wn-col-container"},t._l(t.operarios,function(e){return a("div",{key:e.id,staticClass:"wn-task-container"},[a("Worker",{attrs:{id:e.id,nombre:e.nombre,apellidos:e.apellidos,tags:e.tags,"show-more":e.showMore,conectado:e.conectado}}),t._v(" "),a("div",{staticClass:"wn-btn-div"},[a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.deleteWorker(e.id)}}},[a("i",{staticClass:"fa fa-close ",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("button",{staticClass:"wn-menu-btn",on:{click:function(a){t.inputVisible=!1,t.fillData(e.id),t.dialogEditVisible=!0}}},[a("i",{staticClass:"fa fa-edit ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?t._e():a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!0}}},[a("i",{staticClass:"fa fa-eye ",attrs:{"aria-hidden":"true"}})]),t._v(" "),e.showMore?a("button",{staticClass:"wn-menu-btn",on:{click:function(t){e.showMore=!1}}},[a("i",{staticClass:"fa fa-eye-slash ",attrs:{"aria-hidden":"true"}})]):t._e()])],1)}))]),t._v(" "),a("el-dialog",{attrs:{title:"Alta nuevo operario",visible:t.dialogVisible,width:"65%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"modal_new_worker",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Nombre:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre del operario"},model:{value:t.frm_nombre,callback:function(e){t.frm_nombre=e},expression:"frm_nombre"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Apellidos:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Apellidos del operario"},model:{value:t.frm_apellidos,callback:function(e){t.frm_apellidos=e},expression:"frm_apellidos"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Contraseña:",required:""}},[a("el-input",{attrs:{type:"password",placeholder:"123456"},model:{value:t.frm_pass,callback:function(e){t.frm_pass=e},expression:"frm_pass"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Repetir contraseña:",required:""}},[a("el-input",{attrs:{type:"password",placeholder:"123456"},model:{value:t.frm_pass_2,callback:function(e){t.frm_pass_2=e},expression:"frm_pass_2"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frm_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"23%","font-size":"10px"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("Cancelar")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createWorker}},[t._v("Crear")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Editar operario",visible:t.dialogEditVisible,width:"65%"},on:{"update:visible":function(e){t.dialogEditVisible=e}}},[a("el-form",{ref:"modal_edit_worker",attrs:{"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"Nombre:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Nombre del operario"},model:{value:t.frmO_nombre,callback:function(e){t.frmO_nombre=e},expression:"frmO_nombre"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Apellidos:",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"Apellidos del operario"},model:{value:t.frmO_apellidos,callback:function(e){t.frmO_apellidos=e},expression:"frmO_apellidos"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Contraseña:",required:""}},[a("el-input",{attrs:{type:"password",placeholder:"123456"},model:{value:t.frmO_pass,callback:function(e){t.frmO_pass=e},expression:"frmO_pass"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Etiquetas:",required:""}},[t._l(t.frmO_etiquetas,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisible?a("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"23%","font-size":"10px"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"Nombre nueva etiqueta"},on:{select:t.handleSelectTag},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ Nuevo tag")])],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogEditVisible=!1}}},[t._v("Cancelar")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.editWorker}},[t._v("Guardar")])],1)],1)],1)},staticRenderFns:[]};var $=a("VU/8")(R,A,!1,function(t){a("qKEi")},null,null).exports,B={name:"initial",data:function(){return{showIcon:!0,showTitle:!0,showLogin:!1,email:"",password:""}},methods:{handleClickIcon:function(){this.showIcon=!1,this.showTitle=!1,this.showLogin=!0},handleLogin:function(t){var e=this;"operario@watchnext.com"==this.email?this.$notify.error({title:"Error en el Login",message:"Acceso denegado",position:"top-left"}):h.a.auth().signInWithEmailAndPassword(this.email,this.password).then(function(t){alert("¡Bienvenido "+t.email+"!"),e.$router.push("/dashboard")},function(t){e.$notify.error({title:"Error en el Login",message:t.message,position:"top-left"})}),t.preventDefault()}}},U={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("body",{staticClass:"flex-box text-center"},[i("div",{staticClass:"flex-box background"},[i("div",{staticClass:"flex-box cover-container d-flex h-100 p-3 mx-auto flex-column"},[i("div",{staticClass:"flex-box"},[i("transition",{attrs:{name:"fade"}},[t.showTitle?i("h1",{directives:[{name:"animation",rawName:"v-animation"}],staticClass:"cover-heading welcome"},[t._v("WatchNext®")]):t._e()]),t._v(" "),i("transition",{attrs:{name:"lupa"}},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.showIcon,expression:"showIcon"}],staticClass:"logo reflex",attrs:{src:a("/oeH"),title:"Login"},on:{click:t.handleClickIcon}})]),t._v(" "),i("el-dialog",{staticStyle:{"margin-top":"-50px"},attrs:{visible:t.showLogin,width:"460px","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showLogin=e}}},[i("h1",{staticStyle:{"margin-top":"-30px","padding-bottom":"30px"}},[t._v("Login")]),t._v(" "),i("div",{staticStyle:{height:"140px","margin-left":"-20px","margin-right":"-20px","margin-bottom":"30px",background:"cadetblue"}},[i("img",{staticClass:"logo",staticStyle:{width:"100px",height:"100px","margin-top":"20px"},attrs:{src:a("/oeH"),title:"Login"}})]),t._v(" "),i("el-form",{ref:"form",attrs:{model:t.form,"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"Usuario:",required:""}},[i("el-input",{attrs:{type:"text",placeholder:"Usuario"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"Contraseña:",required:""}},[i("el-input",{attrs:{type:"password",placeholder:"Contraseña"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"btn-login reflex",attrs:{type:"primary"},on:{click:t.handleLogin}},[t._v("Login")])],1)],1)],1)])])])},staticRenderFns:[]};var H=a("VU/8")(B,U,!1,function(t){a("vzHD")},"data-v-bda2290c",null).exports;i.default.use(c.a);var j=new c.a({routes:[{path:"/dashboard",name:"dashboard",component:D,meta:{requiresAuth:!0}},{path:"/gestiones",name:"gestiones",component:P,meta:{requiresAuth:!0}},{path:"/task",name:"new-task",component:L,meta:{requiresAuth:!0}},{path:"/gestionoperarios",name:"gestionoperarios",component:$,meta:{requiresAuth:!0}},{path:"/",name:"initial",component:H}]});j.beforeEach(function(t,e,a){t.matched.some(function(t){return t.meta.requiresAuth})?h.a.auth().currentUser?a():(alert("No puedes usar WatchNext sin loguearte"),a({path:"/",query:{redirect:t.fullPath}})):a()});var G=j,J=(a("Jmt5"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",[e("router-view")],1)])},staticRenderFns:[]});var K=a("VU/8")({name:"app"},J,!1,function(t){a("L8rs")},null,null).exports;i.default.use(r.a,{locale:n.a}),i.default.use(l.a),i.default.config.productionTip=!1;var Q=void 0;h.a.auth().onAuthStateChanged(function(t){Q||(Q=new i.default({el:"#app",render:function(t){return t(K)},router:G,template:"<App/>",components:{App:K}}))})},NJ2c:function(t,e){},Vyxl:function(t,e){},a91A:function(t,e){},kwEI:function(t,e){},qK2r:function(t,e){},qKEi:function(t,e){},sCLF:function(t,e){},tvR6:function(t,e){},vzHD:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.9936f2a72da89f50657a.js.map